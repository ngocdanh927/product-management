extends ../../layout/default.pug
include ../../mixins/select-tree.pug

block main
  
  //- Page Header
  .d-flex.justify-content-between.align-items-center.mb-4
    div
      h2.fw-bold.mb-1
        i.bi.bi-pencil-square.me-2.text-warning
        | Chỉnh Sửa Danh Mục
      p.text-muted.mb-0 Cập nhật thông tin danh mục
    a.btn.btn-outline-secondary(href=`${prefixAdmin}/post-category`)
      i.bi.bi-arrow-left.me-2
      | Quay Lại

  //- Form
  form(
    action=`${prefixAdmin}/post-category/edit/${category._id}?_method=PATCH`
    method="POST"
    enctype="multipart/form-data"
    id="form-edit-category"
  )
    .row
      //- Left Column
      .col-lg-8
        //- Basic Info
        .card.mb-3.border-0.shadow-sm
          .card-header.bg-white
            h6.mb-0.fw-semibold
              i.bi.bi-info-circle.me-2
              | Thông Tin Cơ Bản
          .card-body
            //- Title
            .mb-3
              label.form-label.fw-semibold(for="title")
                | Tên danh mục
                span.text-danger *
              input.form-control(
                type="text"
                id="title"
                name="title"
                placeholder="Nhập tên danh mục..."
                value=category.title
              )
              .form-text Tên danh mục hiển thị trên website

            //- Parent Category
            .mb-3
              label.form-label.fw-semibold(for="parent_id")
                i.bi.bi-diagram-3.me-1
                | Danh mục cha
              select.form-select(
                id="parent_id"
                name="parent_id"
              )
                option(value="") -- Chọn danh mục cha --
                if listCategory
                  +select-tree(listCategory,0,category.parent_id)
              .form-text Để trống nếu là danh mục gốc

            //- Description
            .mb-3
              label.form-label.fw-semibold(for="description") Mô tả
              textarea.form-control.tinymce(
                id="description"
                name="description"
                rows="5"
                placeholder="Nhập mô tả danh mục..."
              ) #{category.description}
              .form-text Mô tả chi tiết về danh mục

      //- Right Column
      .col-lg-4
        //- Image
        .card.mb-3.border-0.shadow-sm
          .card-header.bg-white
            h6.mb-0.fw-semibold
              i.bi.bi-image.me-2
              | Hình Ảnh
          .card-body
            label.form-label.fw-semibold(for="thumbnail") Ảnh đại diện
            
            //- Current Image
            if category.thumbnail
              .mb-3.text-center
                p.text-muted.small Ảnh hiện tại:
                img.img-thumbnail.rounded(
                  src=category.thumbnail
                  alt=category.title
                  style="max-width: 200px"
                )
            
            //- Upload Area
            .upload-image
              .border.border-2.border-dashed.rounded.p-4.text-center.mb-3.bg-light
                input.d-none(
                  type="file"
                  id="thumbnail"
                  name="thumbnail"
                  accept="image/*"
                  upload-image-input
                )
                label.d-block(for="thumbnail" style="cursor: pointer")
                  i.bi.bi-cloud-upload.display-4.text-primary.d-block.mb-2
                  p.mb-1.fw-semibold Click để đổi ảnh
                  small.text-muted Kéo thả ảnh vào đây
                  br
                  small.text-muted PNG, JPG (Max: 2MB)
              
              //- Preview New Image
              .form-imagePreview.d-none.text-center
                button.btn-close(type="button" btn-remove-imagePreview)
                img.img-thumbnail.rounded(
                  src=category.thumbnail
                  alt="Preview"
                  upload-image-preview
                  style="max-width: 100%"
                )

        //- Settings
        .card.mb-3.border-0.shadow-sm
          .card-header.bg-white
            h6.mb-0.fw-semibold
              i.bi.bi-gear.me-2
              | Cài Đặt
          .card-body
            //- Position
            .mb-3
              label.form-label.fw-semibold(for="position")
                i.bi.bi-sort-numeric-down.me-1
                | Vị trí hiển thị
              input.form-control(
                type="number"
                id="position"
                name="position"
                min="1"
                value=category.position
              )
              .form-text Để trống để tự động

            //- Status
            .mb-3
              label.form-label.fw-semibold.d-block.mb-2
                i.bi.bi-toggle-on.me-1
                | Trạng thái
              
              .form-check.border.rounded.p-3.mb-2
                input.form-check-input(
                  type="radio"
                  id="statusInStock"
                  name="status"
                  value="In Stock"
                  checked =(category.status==="In Stock"? true:false)
                )
                label.form-check-label.ms-2(for="statusInStock")
                  i.bi.bi-check-circle-fill.text-success
                  |  còn hàng

              .form-check.border.rounded.p-3
                input.form-check-input(
                  type="radio"
                  id="statusLowStock"
                  name="status"
                  value="Low Stock"
                  checked =(category.status==="Low Stock"? true:false)
                )
                label.form-check-label.ms-2(for="statusLowStock")
                  i.bi.bi-x-circle-fill.text-danger
                  |  hết hàng

    //- Actions
    .card.border-0.shadow-sm.mt-4
      .card-body
        .d-flex.justify-content-between.align-items-center
          div
            a.btn.btn-outline-danger(href=`${prefixAdmin}/post-category`)
              i.bi.bi-x-circle.me-2
              | Hủy
          button.btn.btn-warning.btn-lg.text-white(type="submit")
            i.bi.bi-check-circle.me-2
            | Cập Nhật
